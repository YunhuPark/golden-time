<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Golden Time - ìˆ˜ë™ ì˜ˆì™¸ í…ŒìŠ¤íŠ¸</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    h1 {
      color: #FF3B30;
      margin-bottom: 30px;
      text-align: center;
    }

    .test-section {
      margin-bottom: 40px;
      padding: 20px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
    }

    .test-section h2 {
      color: #333;
      margin-bottom: 15px;
      font-size: 20px;
    }

    .test-section p {
      color: #666;
      margin-bottom: 15px;
      line-height: 1.6;
    }

    button {
      background: #FF3B30;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      margin-right: 10px;
      margin-bottom: 10px;
      transition: background 0.2s;
    }

    button:hover {
      background: #e6342a;
    }

    button.secondary {
      background: #007AFF;
    }

    button.secondary:hover {
      background: #0062cc;
    }

    .result {
      margin-top: 15px;
      padding: 15px;
      border-radius: 6px;
      font-size: 14px;
      display: none;
    }

    .result.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .result.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .result.info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }

    pre {
      background: #f8f8f8;
      padding: 10px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 12px;
      margin-top: 10px;
    }

    .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 10px;
    }

    .badge.pass {
      background: #28a745;
      color: white;
    }

    .badge.fail {
      background: #dc3545;
      color: white;
    }

    .badge.pending {
      background: #ffc107;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¥ Golden Time - ì˜ˆì™¸ ì²˜ë¦¬ ìˆ˜ë™ í…ŒìŠ¤íŠ¸</h1>

    <!-- ì„¸ì…˜ ë§Œë£Œ í…ŒìŠ¤íŠ¸ -->
    <div class="test-section">
      <h2>ğŸ” 1. ë¡œê·¸ì¸ ì„¸ì…˜ ë§Œë£Œ í…ŒìŠ¤íŠ¸ <span class="badge pending" id="test1-badge">ëŒ€ê¸°</span></h2>
      <p>
        <strong>ëª©ì :</strong> SessionExpiredModalì´ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸<br>
        <strong>ë°©ë²•:</strong> localStorageì—ì„œ Supabase í† í°ì„ ì œê±°í•˜ì—¬ ì„¸ì…˜ ë§Œë£Œ ì‹œë®¬ë ˆì´ì…˜
      </p>

      <button onclick="testSessionExpiry()">ì„¸ì…˜ ë§Œë£Œ ì‹œë®¬ë ˆì´ì…˜</button>
      <button class="secondary" onclick="window.open('http://localhost:3000', '_blank')">ì•± ì—´ê¸°</button>

      <div class="result" id="test1-result"></div>
    </div>

    <!-- ë„¤íŠ¸ì›Œí¬ ì˜¤í”„ë¼ì¸ í…ŒìŠ¤íŠ¸ -->
    <div class="test-section">
      <h2>ğŸ“¡ 2. ë„¤íŠ¸ì›Œí¬ ì˜¤í”„ë¼ì¸ í…ŒìŠ¤íŠ¸ <span class="badge pending" id="test2-badge">ëŒ€ê¸°</span></h2>
      <p>
        <strong>ëª©ì :</strong> NetworkStatusBanner í‘œì‹œ ë° ìºì‹œ ë°ì´í„° ì‚¬ìš© í™•ì¸<br>
        <strong>ë°©ë²•:</strong> Chrome DevToolsì—ì„œ ë„¤íŠ¸ì›Œí¬ë¥¼ Offlineìœ¼ë¡œ ì„¤ì •
      </p>

      <button onclick="openDevTools()">DevTools ê°€ì´ë“œ ë³´ê¸°</button>
      <button class="secondary" onclick="testNetworkStatus()">ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸</button>

      <div class="result" id="test2-result"></div>
    </div>

    <!-- ìºì‹œ í…ŒìŠ¤íŠ¸ -->
    <div class="test-section">
      <h2>ğŸ’¾ 3. HospitalCache í…ŒìŠ¤íŠ¸ <span class="badge pending" id="test3-badge">ëŒ€ê¸°</span></h2>
      <p>
        <strong>ëª©ì :</strong> localStorage ìºì‹œê°€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸<br>
        <strong>ë°©ë²•:</strong> ìºì‹œ ì €ì¥/ë¡œë“œ/ë§Œë£Œ í…ŒìŠ¤íŠ¸
      </p>

      <button onclick="testCacheSave()">ìºì‹œ ì €ì¥ í…ŒìŠ¤íŠ¸</button>
      <button onclick="testCacheLoad()">ìºì‹œ ë¡œë“œ í…ŒìŠ¤íŠ¸</button>
      <button onclick="testCacheClear()">ìºì‹œ ì‚­ì œ</button>

      <div class="result" id="test3-result"></div>
    </div>

    <!-- Sentry ë¡œê¹… í…ŒìŠ¤íŠ¸ -->
    <div class="test-section">
      <h2>ğŸ“Š 4. Sentry ì—ëŸ¬ ë¡œê¹… í…ŒìŠ¤íŠ¸ <span class="badge pending" id="test4-badge">ëŒ€ê¸°</span></h2>
      <p>
        <strong>ëª©ì :</strong> Sentryê°€ ì—ëŸ¬ë¥¼ ì •ìƒì ìœ¼ë¡œ ìº¡ì²˜í•˜ëŠ”ì§€ í™•ì¸<br>
        <strong>ë°©ë²•:</strong> ê°•ì œë¡œ ì—ëŸ¬ ë°œìƒì‹œì¼œ Sentry ëŒ€ì‹œë³´ë“œ í™•ì¸
      </p>

      <button onclick="testSentryError()">í…ŒìŠ¤íŠ¸ ì—ëŸ¬ ë°œìƒ</button>
      <button class="secondary" onclick="window.open('https://sentry.io', '_blank')">Sentry ëŒ€ì‹œë³´ë“œ</button>

      <div class="result" id="test4-result"></div>
    </div>

    <!-- ì¢…í•© í…ŒìŠ¤íŠ¸ -->
    <div class="test-section">
      <h2>âœ… 5. ì¢…í•© ìƒíƒœ í™•ì¸</h2>
      <p>
        <strong>ëª©ì :</strong> ì „ì²´ ì‹œìŠ¤í…œ ìƒíƒœ ë° ì„¤ì • í™•ì¸
      </p>

      <button onclick="checkSystemStatus()">ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸</button>
      <button onclick="runAllTests()">ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>

      <div class="result" id="test5-result"></div>
    </div>
  </div>

  <script>
    // í…ŒìŠ¤íŠ¸ 1: ì„¸ì…˜ ë§Œë£Œ ì‹œë®¬ë ˆì´ì…˜
    function testSessionExpiry() {
      const result = document.getElementById('test1-result');
      const badge = document.getElementById('test1-badge');

      try {
        // Supabase í† í° ì œê±°
        const removedItems = [];

        // Supabase ê´€ë ¨ ëª¨ë“  í‚¤ ì œê±°
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key && key.includes('supabase') || key.includes('sb-')) {
            removedItems.push(key);
          }
        }

        removedItems.forEach(key => localStorage.removeItem(key));
        sessionStorage.clear();

        result.className = 'result success';
        result.style.display = 'block';
        result.innerHTML = `
          âœ… <strong>ì„¸ì…˜ ë§Œë£Œ ì‹œë®¬ë ˆì´ì…˜ ì„±ê³µ!</strong><br>
          ì œê±°ëœ í•­ëª©: ${removedItems.length}ê°œ<br>
          <pre>${removedItems.join('\\n') || 'ì—†ìŒ'}</pre>
          <br>
          <strong>ë‹¤ìŒ ë‹¨ê³„:</strong>
          <ol>
            <li>ì•± ì—´ê¸° ë²„íŠ¼ í´ë¦­</li>
            <li>ë¡œê·¸ì¸ ìˆ˜í–‰</li>
            <li>ë³‘ì› ì¦ê²¨ì°¾ê¸° ì¶”ê°€</li>
            <li>ì´ ì°½ì—ì„œ ë‹¤ì‹œ "ì„¸ì…˜ ë§Œë£Œ ì‹œë®¬ë ˆì´ì…˜" í´ë¦­</li>
            <li>ì•±ì—ì„œ ì¦ê²¨ì°¾ê¸° ì œê±° ì‹œë„</li>
            <li>SessionExpiredModalì´ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸</li>
          </ol>
        `;
        badge.className = 'badge pass';
        badge.textContent = 'ì„±ê³µ';
      } catch (error) {
        result.className = 'result error';
        result.style.display = 'block';
        result.innerHTML = `âŒ <strong>ì—ëŸ¬ ë°œìƒ:</strong> ${error.message}`;
        badge.className = 'badge fail';
        badge.textContent = 'ì‹¤íŒ¨';
      }
    }

    // í…ŒìŠ¤íŠ¸ 2: ë„¤íŠ¸ì›Œí¬ ìƒíƒœ
    function openDevTools() {
      const result = document.getElementById('test2-result');
      result.className = 'result info';
      result.style.display = 'block';
      result.innerHTML = `
        ğŸ“– <strong>Chrome DevTools ë„¤íŠ¸ì›Œí¬ ì˜¤í”„ë¼ì¸ ì„¤ì •:</strong><br>
        <ol>
          <li>F12 í‚¤ë¥¼ ëˆŒëŸ¬ DevTools ì—´ê¸°</li>
          <li>"Network" íƒ­ í´ë¦­</li>
          <li>ìƒë‹¨ì˜ "Online" ë“œë¡­ë‹¤ìš´ í´ë¦­</li>
          <li>"Offline" ì„ íƒ</li>
          <li>ì•± í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ (F5)</li>
          <li>NetworkStatusBanner ìƒë‹¨ì— í‘œì‹œë˜ëŠ”ì§€ í™•ì¸</li>
          <li>"Online" ì„ íƒí•˜ì—¬ ë³µêµ¬</li>
          <li>ì¬ì—°ê²° ë°°ë„ˆ í‘œì‹œ ë° ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ í™•ì¸</li>
        </ol>
      `;
    }

    function testNetworkStatus() {
      const result = document.getElementById('test2-result');
      const badge = document.getElementById('test2-badge');

      const isOnline = navigator.onLine;

      result.className = isOnline ? 'result success' : 'result error';
      result.style.display = 'block';
      result.innerHTML = `
        ${isOnline ? 'âœ…' : 'âŒ'} <strong>í˜„ì¬ ë„¤íŠ¸ì›Œí¬ ìƒíƒœ: ${isOnline ? 'ONLINE' : 'OFFLINE'}</strong><br>
        <br>
        <strong>useNetworkStatus Hook í…ŒìŠ¤íŠ¸:</strong><br>
        - navigator.onLine: ${navigator.onLine}<br>
        - ì•±ì—ì„œ window.addEventListener('online/offline') ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì‘ë™ í™•ì¸<br>
      `;

      badge.className = 'badge pass';
      badge.textContent = isOnline ? 'ONLINE' : 'OFFLINE';
    }

    // í…ŒìŠ¤íŠ¸ 3: ìºì‹œ ê¸°ëŠ¥
    function testCacheSave() {
      const result = document.getElementById('test3-result');
      const badge = document.getElementById('test3-badge');

      try {
        const mockHospitalData = {
          hospitals: [
            { id: 'test-1', name: 'í…ŒìŠ¤íŠ¸ ë³‘ì› 1', availableBeds: 5 },
            { id: 'test-2', name: 'í…ŒìŠ¤íŠ¸ ë³‘ì› 2', availableBeds: 10 }
          ],
          location: { lat: 37.5665, lon: 126.9780 },
          region: 'ì„œìš¸íŠ¹ë³„ì‹œ',
          timestamp: Date.now()
        };

        localStorage.setItem('golden-time-hospital-cache', JSON.stringify(mockHospitalData));

        result.className = 'result success';
        result.style.display = 'block';
        result.innerHTML = `
          âœ… <strong>ìºì‹œ ì €ì¥ ì„±ê³µ!</strong><br>
          <pre>${JSON.stringify(mockHospitalData, null, 2)}</pre>
        `;
        badge.className = 'badge pass';
        badge.textContent = 'ì €ì¥ë¨';
      } catch (error) {
        result.className = 'result error';
        result.style.display = 'block';
        result.innerHTML = `âŒ <strong>ì—ëŸ¬:</strong> ${error.message}`;
        badge.className = 'badge fail';
        badge.textContent = 'ì‹¤íŒ¨';
      }
    }

    function testCacheLoad() {
      const result = document.getElementById('test3-result');
      const badge = document.getElementById('test3-badge');

      try {
        const cached = localStorage.getItem('golden-time-hospital-cache');

        if (!cached) {
          result.className = 'result error';
          result.style.display = 'block';
          result.innerHTML = `âŒ <strong>ìºì‹œ ì—†ìŒ</strong><br>ë¨¼ì € "ìºì‹œ ì €ì¥ í…ŒìŠ¤íŠ¸" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.`;
          badge.className = 'badge fail';
          badge.textContent = 'ì—†ìŒ';
          return;
        }

        const data = JSON.parse(cached);
        const ageMinutes = Math.floor((Date.now() - data.timestamp) / 60000);
        const isFresh = ageMinutes < 5;

        result.className = 'result success';
        result.style.display = 'block';
        result.innerHTML = `
          âœ… <strong>ìºì‹œ ë¡œë“œ ì„±ê³µ!</strong><br>
          ë³‘ì› ìˆ˜: ${data.hospitals?.length || 0}ê°œ<br>
          ì§€ì—­: ${data.region}<br>
          ìºì‹œ ë‚˜ì´: ${ageMinutes}ë¶„ ì „<br>
          ì‹ ì„ ë„: ${isFresh ? 'ğŸŸ¢ Fresh (5ë¶„ ì´ë‚´)' : 'ğŸŸ¡ Stale (5ë¶„ ì´ìƒ)'}<br>
          <pre>${JSON.stringify(data, null, 2)}</pre>
        `;
        badge.className = 'badge pass';
        badge.textContent = `${ageMinutes}ë¶„ ì „`;
      } catch (error) {
        result.className = 'result error';
        result.style.display = 'block';
        result.innerHTML = `âŒ <strong>ì—ëŸ¬:</strong> ${error.message}`;
        badge.className = 'badge fail';
        badge.textContent = 'ì‹¤íŒ¨';
      }
    }

    function testCacheClear() {
      const result = document.getElementById('test3-result');
      const badge = document.getElementById('test3-badge');

      localStorage.removeItem('golden-time-hospital-cache');

      result.className = 'result success';
      result.style.display = 'block';
      result.innerHTML = `âœ… <strong>ìºì‹œ ì‚­ì œ ì™„ë£Œ!</strong>`;
      badge.className = 'badge pending';
      badge.textContent = 'ì‚­ì œë¨';
    }

    // í…ŒìŠ¤íŠ¸ 4: Sentry
    function testSentryError() {
      const result = document.getElementById('test4-result');
      const badge = document.getElementById('test4-badge');

      try {
        // ê°•ì œ ì—ëŸ¬ ë°œìƒ
        throw new Error('í…ŒìŠ¤íŠ¸ ì—ëŸ¬: Golden Time ì˜ˆì™¸ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸');
      } catch (error) {
        result.className = 'result info';
        result.style.display = 'block';
        result.innerHTML = `
          â„¹ï¸ <strong>í…ŒìŠ¤íŠ¸ ì—ëŸ¬ ë°œìƒë¨</strong><br>
          <pre>${error.stack}</pre>
          <br>
          <strong>Sentry í™•ì¸ ë°©ë²•:</strong><br>
          1. Sentry ëŒ€ì‹œë³´ë“œ ë²„íŠ¼ í´ë¦­<br>
          2. í”„ë¡œì íŠ¸ ì„ íƒ<br>
          3. Issues íƒ­ì—ì„œ "í…ŒìŠ¤íŠ¸ ì—ëŸ¬" ê²€ìƒ‰<br>
          4. ì´ë²¤íŠ¸ ìƒì„¸ ì •ë³´ í™•ì¸ (ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤, ë¸Œë¼ìš°ì € ì •ë³´ ë“±)<br>
          <br>
          <strong>ì£¼ì˜:</strong> .envì— VITE_SENTRY_DSNì´ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤!
        `;
        badge.className = 'badge pass';
        badge.textContent = 'ë°œìƒ';
      }
    }

    // í…ŒìŠ¤íŠ¸ 5: ì‹œìŠ¤í…œ ìƒíƒœ
    function checkSystemStatus() {
      const result = document.getElementById('test5-result');

      const status = {
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        language: navigator.language,
        online: navigator.onLine,
        cookieEnabled: navigator.cookieEnabled,
        localStorage: typeof localStorage !== 'undefined',
        sessionStorage: typeof sessionStorage !== 'undefined',
        geolocation: 'geolocation' in navigator,
        serviceWorker: 'serviceWorker' in navigator,
        cache: !!localStorage.getItem('golden-time-hospital-cache'),
        supabaseTokens: []
      };

      // Supabase í† í° í™•ì¸
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key && (key.includes('supabase') || key.includes('sb-'))) {
          status.supabaseTokens.push(key);
        }
      }

      result.className = 'result info';
      result.style.display = 'block';
      result.innerHTML = `
        ğŸ“Š <strong>ì‹œìŠ¤í…œ ìƒíƒœ:</strong><br>
        <pre>${JSON.stringify(status, null, 2)}</pre>
      `;
    }

    function runAllTests() {
      alert('ê° í…ŒìŠ¤íŠ¸ë¥¼ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•˜ì„¸ìš”:\\n\\n1. ì„¸ì…˜ ë§Œë£Œ ì‹œë®¬ë ˆì´ì…˜\\n2. ë„¤íŠ¸ì›Œí¬ ì˜¤í”„ë¼ì¸ í…ŒìŠ¤íŠ¸\\n3. ìºì‹œ í…ŒìŠ¤íŠ¸\\n4. Sentry ì—ëŸ¬ ë¡œê¹…\\n5. ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸');
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì‹¤í–‰
    window.addEventListener('load', () => {
      console.log('ğŸ§ª Golden Time ì˜ˆì™¸ í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œë¨');
      checkSystemStatus();
    });
  </script>
</body>
</html>
